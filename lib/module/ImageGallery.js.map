{"version":3,"names":["React","useEffect","useRef","useState","useCallback","Dimensions","FlatList","Image","Modal","StyleSheet","TouchableOpacity","View","ImagePreview","SwipeContainer","height","deviceHeight","width","deviceWidth","get","defaultProps","hideThumbs","resizeMode","thumbColor","thumbResizeMode","thumbSize","ImageGallery","props","close","images","initialIndex","isOpen","renderCustomImage","renderCustomThumb","renderFooterComponent","renderHeaderComponent","disableSwipe","activeIndex","setActiveIndex","isDragging","setIsDragging","topRef","bottomRef","keyExtractorThumb","item","index","id","toString","keyExtractorImage","scrollToIndex","i","current","animated","_bottomRef$current","_bottomRef$current2","renderItem","createElement","isSelected","renderThumb","onPress","activeOpacity","style","styles","thumb","activeThumb","borderColor","source","uri","thumbUrl","url","onMomentumEnd","e","x","nativeEvent","contentOffset","Math","round","getImageLayout","_","length","offset","getThumbLayout","animationType","visible","container","initialScrollIndex","getItemLayout","data","horizontal","keyExtractor","onMomentumScrollEnd","pagingEnabled","ref","scrollEnabled","showsHorizontalScrollIndicator","contentContainerStyle","thumbnailListContainer","bottomFlatlist","bottom","header","footer","create","alignItems","backgroundColor","flex","justifyContent","position","top","borderWidth","borderRadius","marginRight","paddingHorizontal"],"sources":["ImageGallery.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState, useCallback } from 'react';\nimport {\n  Dimensions,\n  FlatList,\n  Image,\n  Modal,\n  StyleSheet,\n  TouchableOpacity,\n  View,\n} from 'react-native';\nimport { ImageObject, IProps, RenderImageProps } from './types';\nimport ImagePreview from './ImagePreview';\nimport SwipeContainer from './SwipeContainer';\n\nconst { height: deviceHeight, width: deviceWidth } = Dimensions.get('window');\n\nconst defaultProps = {\n  hideThumbs: false,\n  resizeMode: 'contain',\n  thumbColor: '#d9b44a',\n  thumbResizeMode: 'cover',\n  thumbSize: 48,\n};\n\nconst ImageGallery = (props: IProps & typeof defaultProps) => {\n  const {\n    close,\n    hideThumbs,\n    images,\n    initialIndex,\n    isOpen,\n    renderCustomImage,\n    renderCustomThumb,\n    renderFooterComponent,\n    renderHeaderComponent,\n    resizeMode,\n    thumbColor,\n    thumbResizeMode,\n    thumbSize,\n    disableSwipe,\n  } = props;\n\n  const [activeIndex, setActiveIndex] = useState(0);\n  const [isDragging, setIsDragging] = useState(false);\n  const topRef = useRef<FlatList>(null);\n  const bottomRef = useRef<FlatList>(null);\n\n  const keyExtractorThumb = (item: ImageObject, index: number) =>\n    item && item.id ? item.id.toString() : index.toString();\n  const keyExtractorImage = (item: ImageObject, index: number) =>\n    item && item.id ? item.id.toString() : index.toString();\n\n  const scrollToIndex = (i: number) => {\n    setActiveIndex(i);\n\n    if (topRef?.current) {\n      topRef.current.scrollToIndex({\n        animated: true,\n        index: i,\n      });\n    }\n    if (bottomRef?.current) {\n      if (i * (thumbSize + 10) - thumbSize / 2 > deviceWidth / 2) {\n        bottomRef?.current?.scrollToIndex({\n          animated: true,\n          index: i,\n        });\n      } else {\n        bottomRef?.current?.scrollToIndex({\n          animated: true,\n          index: 0,\n        });\n      }\n    }\n  };\n\n  const renderItem = ({ item, index }: RenderImageProps) => {\n    return (\n      <ImagePreview\n        index={index}\n        isSelected={activeIndex === index}\n        item={item}\n        resizeMode={resizeMode}\n        renderCustomImage={renderCustomImage}\n      />\n    );\n  };\n\n  const renderThumb = ({ item, index }: RenderImageProps) => {\n    return (\n      <TouchableOpacity\n        onPress={() => scrollToIndex(index)}\n        activeOpacity={0.8}\n      >\n        {renderCustomThumb ? (\n          renderCustomThumb(item, index, activeIndex === index)\n        ) : (\n          <Image\n            resizeMode={thumbResizeMode}\n            style={\n              activeIndex === index\n                ? [\n                    styles.thumb,\n                    styles.activeThumb,\n                    { borderColor: thumbColor },\n                    { width: thumbSize, height: thumbSize },\n                  ]\n                : [styles.thumb, { width: thumbSize, height: thumbSize }]\n            }\n            source={{ uri: item.thumbUrl ? item.thumbUrl : item.url }}\n          />\n        )}\n      </TouchableOpacity>\n    );\n  };\n\n  const onMomentumEnd = (e: any) => {\n    const { x } = e.nativeEvent.contentOffset;\n    scrollToIndex(Math.round(x / deviceWidth));\n  };\n\n  useEffect(() => {\n    if (isOpen && initialIndex) {\n      setActiveIndex(initialIndex);\n    } else if (!isOpen) {\n      setActiveIndex(0);\n    }\n  }, [isOpen, initialIndex]);\n\n  const getImageLayout = useCallback((_, index) => {\n    return {\n      index,\n      length: deviceWidth,\n      offset: deviceWidth * index,\n    };\n  }, []);\n\n  const getThumbLayout = useCallback(\n    (_, index) => {\n      return {\n        index,\n        length: thumbSize,\n        offset: thumbSize * index,\n      };\n    },\n    [thumbSize]\n  );\n\n  return (\n    <Modal animationType={isOpen ? 'slide' : 'fade'} visible={isOpen}>\n      <View style={styles.container}>\n        <SwipeContainer\n          disableSwipe={disableSwipe}\n          setIsDragging={setIsDragging}\n          close={close}\n        >\n          <FlatList\n            initialScrollIndex={initialIndex}\n            getItemLayout={getImageLayout}\n            data={images}\n            horizontal\n            keyExtractor={keyExtractorImage}\n            onMomentumScrollEnd={onMomentumEnd}\n            pagingEnabled\n            ref={topRef}\n            renderItem={renderItem}\n            scrollEnabled={!isDragging}\n            showsHorizontalScrollIndicator={false}\n          />\n        </SwipeContainer>\n        {hideThumbs ? null : (\n          <FlatList\n            initialScrollIndex={initialIndex}\n            getItemLayout={getThumbLayout}\n            contentContainerStyle={styles.thumbnailListContainer}\n            data={props.images}\n            horizontal\n            keyExtractor={keyExtractorThumb}\n            pagingEnabled\n            ref={bottomRef}\n            renderItem={renderThumb}\n            showsHorizontalScrollIndicator={false}\n            style={[styles.bottomFlatlist, { bottom: thumbSize }]}\n          />\n        )}\n        {renderHeaderComponent ? (\n          <View style={styles.header}>\n            {renderHeaderComponent(images[activeIndex], activeIndex)}\n          </View>\n        ) : null}\n        {renderFooterComponent ? (\n          <View style={styles.footer}>\n            {renderFooterComponent(images[activeIndex], activeIndex)}\n          </View>\n        ) : null}\n      </View>\n    </Modal>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    alignItems: 'center',\n    backgroundColor: 'black',\n    flex: 1,\n    height: deviceHeight,\n    justifyContent: 'center',\n    width: deviceWidth,\n  },\n\n  header: {\n    position: 'absolute',\n    top: 0,\n    width: '100%',\n  },\n  footer: {\n    bottom: 0,\n    position: 'absolute',\n    width: '100%',\n  },\n  activeThumb: {\n    borderWidth: 3,\n  },\n  thumb: {\n    borderRadius: 12,\n    marginRight: 10,\n  },\n  thumbnailListContainer: {\n    paddingHorizontal: 10,\n  },\n  bottomFlatlist: {\n    position: 'absolute',\n  },\n});\n\nImageGallery.defaultProps = defaultProps;\n\nexport default ImageGallery;\n"],"mappings":"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","ignoreList":[]}